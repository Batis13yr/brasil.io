{% extends 'base.html' %}
{% load l10n %}
{% load static %}
{% block title %}Covid19 por Município - Brasil.IO{% endblock %}

{% block head %}
  {{ block.super }}
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/dataTables.material.min.css">
{% endblock %}

{% block content %}{% localize on %}

<div>
  <h1> COVID19 no Brasil </h1>

  <h2>
    Municípios com casos confirmados
  </h2>
  <p>
    Total de municípios com casos confirmados: {{ table|length }}.
  </p>

  <p>
    <a class="btn" href="{% url 'core:dataset-table-detail' 'covid19' 'caso' %}&amp;?is_last=True&amp;place_type=city&amp;format=csv">
      Baixar dados em CSV
    </a>
  </p>

  <table class="table mdl-data-table" style="height: 200px">
    <thead>
    <tr>
      <th> Data </th>
      <th> Município </th>
      <th> UF </th>
      <th> Casos confirmados </th>
      <th> Casos/100k hab. </th>
      <th> Mortes </th>
      <th> Mortes/confirmados </th>
    </tr>
    </thead>

    <tbody>
    {% for row in table %}
    <tr>
      <td data-order="{% localize off %}{{ row.date_str }}{% endlocalize %}"> {{ row.date|date:"d \d\e M \d\e Y" }} </td>
      <td data-order="{{ row.city_str }}"> {{ row.city }} </td>
      <td> {{ row.state }} </td>
      <td data-order="{% localize off %}{{ row.confirmed }}{% endlocalize %}"> {{ row.confirmed }} </td>
      <td data-order="{% localize off %}{{ row.confirmed_per_100k_inhabitants }}{% endlocalize %}"> {{ row.confirmed_per_100k_inhabitants|floatformat:2 }} </td>
      <td data-order="{% localize off %}{{ row.deaths }}{% endlocalize %}"> {{ row.deaths }} </td>
      <td data-order="{% localize off %}{{ row.death_rate }}{% endlocalize %}"> {{ row.death_rate|floatformat:2 }}% </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>

  <p>
    <br> <br> <br> <br> <br> <br> <br> <br>
  </p>
</div>

{% endlocalize %}
{% endblock %}

{% block script %}
{{ block.super }}
<script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<script type="text/javascript">
  var dt;
$(document).ready(function() {
  dt = $('.mdl-data-table').DataTable({
      "scrollY":        "200px",
      "scrollCollapse": true,
      "paging":         false,
      "searching":      true,
      "bInfo":          false,
      "order": [3, "desc"],
      });
});
</script>
{% endblock %}
